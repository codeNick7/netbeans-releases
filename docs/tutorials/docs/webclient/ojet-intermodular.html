<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="../../../netbeans.css">
        <title>Strategies for Intermodular Communication in Oracle JET</title>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta name="description" content="A tutorial that introduces the support for developing HTML5 applications in NetBeans IDE
              and uses the jQuery JavaScript library.">
        <meta name="keywords" content="NetBeans, IDE, integrated development environment, jQuery, JavaScript, CSS, HTML5">
    </head>
    <body>

        <!--
        Copyright (c) 2016, Oracle and/or its affiliates. All rights reserved.
        -->

        <h1>Strategies for Intermodular Communication in Oracle JET</h1>

        <p>
            This document provides a step-by-step set of instructions guiding
            you through the different approaches for communicating between modules defined by the
            <a href="http://oraclejet.org">Oracle JavaScript Extension Toolkit (JET)</a>. JET empowers web
            and mobile developers
            by providing a modular toolkit based on modern JavaScript, CSS3,
            and HTML5 design and development principles.</p>

        <!-- ++++++++++++++++ Setting Up ++++++++++++++++ -->
        <a name="settingUp"></a>
        <h2>Setting Up an Oracle JET Application</h2>
        <p>In this exercise you set up an Oracle JET application.</p>
        <ol>
            <li>
            <p>Follow the steps described in <a href="ojet-settingup.html">Setting Up an Oracle JET Application</a>.</p>
            <li><p>Open the project into an editor or IDE of your choice, such as NetBeans IDE, which
                displays the application as follows:</p>
                <p><img src="../../../images_www/articles/82/web/oraclejet-gettingstarted/navdrawer.png"/></p>
            </li>
        </ol>    
            <p>Spend some time browsing through the application structure before continuing.</p>
        
        <!-- ++++++++++++++++ Understanding ++++++++++++++++ -->
        <a name="understanding"></a>
        <h2>Global Variables</h2>
        <p>In this exercise, you learn about where and how to set global variables
             in an Oracle JET application.</p>
        <ol>
            <li>
              <p>Knockout.js has the concept of a "binding context", which are global objects
               that can be referenced throughout your application. Spend some time learning about <a href="http://knockoutjs.com/documentation/binding-context.html">the binding
               context here</a>.
              </p>
            </li>
            <li>
                <p>
                    In any of your Oracle JET module's views, i.e., any of the HTML files
                    that define the view of the Oracle JET modules, add the following:
                </p>
                <pre>&lt;p&gt;User Login Name: &lt;input data-bind="textInput: <b>$root.userLogin</b>"&gt;&lt;/input&gt;&lt;/p&gt;</pre>
                <p class="tips">Take note of the <tt>$root</tt> binding context in the above.</p>
            </li>
            <li>
               <p>In the browser, notice there is already content in the input field.
                  Make a change in the input field and notice that something in the menubar changes!</p>
            </li>
            <li>
                <p>
                    Open the <tt>appController.js</tt> file in the <tt>src/js</tt> file. In
                    that file, notice the following property has been defined:
                </p>
                <pre>self.userLogin = ko.observable("john.hancock@oracle.com");</pre>
            </li>
            <li>
                <p>
                    Create a new global variable, as follows:</p>
                <pre>self.stepArray = 
        ko.observableArray(
                [{label:'Step 1', id:'dashboard'},
                 {label:'Step 2', id:'customers'},
                 {label:'Step 3', id:'incidents'},
                 {label:'Step 4', id:'about'}]);</pre>    
            
                <p>In the <tt>index.html</tt> file, replace
                    <tt>ojNavigationList</tt> with <tt>ojTrain</tt>,
                    as follows:</p>
                <pre>&lt;div id="train" 
       class="oj-train-stretch" 
       style="max-width:1500px;margin-left:auto;margin-right:auto;"
       data-bind="ojComponent:{
         component: 'ojTrain', 
         selectedStep: router.stateId, 
         steps: stepArray}"&gt;
&lt;/div&gt;</pre>
                <p class="tips">Make sure to include <tt>ojs/ojtrain</tt>
                    in the <tt>require</tt> block in <tt>main.js</tt>.</p>
                <p>In the browser, notice that you have now replaced
                 the navigation list with a train-based step component:</p>
                <p><img style="border:1px solid black" src="../../../images_www/articles/82/web/oraclejet-gettingstarted/ojtrain.png"/></p>
            </li>
            <li>
                <p>Create your own global variable and refer to it
                 in your Oracle JET application.</p>
            </li>
        </ol>
        
        <p class="tips">The <tt>src/js/appController.js</tt> file is the central location
             in an Oracle JET application where global variables are defined
             and from which they can be accessed throughout the application.</p>
        
         <!-- ++++++++++++++++ Understanding ++++++++++++++++ -->
        <a name="event"></a>
        <h2>Unobtrusive Event Handling</h2>
        <p>If you need to get at a value that is being used in a 
            different JavaScript file (not in the HTML file, as shown
            in the previous scenario above), 
            you can take a look at the Knockout <tt>dataFor</tt>
            and <tt>contextFor</tt> methods.</p>
        <ol>
            <li>
              <p>Knockout.js has the concept of a "binding context", which are global objects
               that can be referenced throughout your application. Spend some time learning about <a href="http://knockoutjs.com/documentation/binding-context.html">the binding
               context here</a>.
              </p>
              <pre>var rootViewModel = ko.dataFor(document.getElementById('globalBody'));
self.userLogin = rootViewModel.userLogin;</pre>
              <p class="tips"> If you're wondering where the
                  element ID <tt>globalBody</tt> comes from,
                  take a look in your <tt>index.html</tt> file.
              </p>
            </li>
            <li>
                <p>Now, instead of needing to refer to the <tt>$root</tt> binding context,
                you have a normal Knockout.js observable property that you can
                reference instead:</p>
                <pre>&lt;p&gt;Name: &lt;span data-bind="text: <b>userLogin</b>"&gt;&lt;/span&gt;&lt;/p&gt;</pre>
            </li>
            <li>
                <p>Similarly, you can now get hold of the router and use it as follows:</p>
<pre>var rootViewModel = ko.dataFor(document.getElementById('globalBody'));
rootViewModel.router.go('dashboard');</pre>
                <p class="tips">A different approach is to load the <tt>appController.js</tt> via the <tt>define</tt>
                block and use it after referencing it in the callback function.</p>              
            </li>
        </ol>
        <p>Make the above changes in your application and check that
         everything still works.</p>
        <!-- ++++++++++++++++ Creating ++++++++++++++++ -->
        <a name="creating"></a>
        <h2>Publish/Subscribe with Knockout Postbox</h2>
        <p>In this exercise, you integrate and use <a href="https://github.com/rniemeyer/knockout-postbox">knockout-postbox</a>
             in your Oracle JET application.</p>
        <ol>
            <li>In your <tt>package.json</tt> file, include <tt>knockout-postbox</tt>:
                <pre>"knockout-postbox": "0.6.0"</pre>
            </li>
            <li>In your <tt>scripts/grunt/config/oraclejet-build.js</tt> file, 
                include <tt>knockout-postbox</tt> in the <tt>ojet build</tt> process:
                <pre>copyCustomLibsToStaging: {
  fileList: [
   {
     cwd:'node_modules/knockout-postbox/build',
     src: ['*'],
     dest: 'web/js/libs/knockout-postbox'
   }
  ]
 },</pre>
            </li>
            <li><p>When you run <tt>ojet-build</tt>, you should see <tt>knockout-postbox</tt>
                    in <tt>web/js/libs</tt>.</p>
            </li>
            <li>
                <p>Include the library in <tt>main.js</tt>, in the
                    <tt>requirejs.config section</tt>:</p>
<pre>'knockout-postbox': 'libs/knockout-postbox/knockout-postbox'</pre>
                
            </li>
            <li>
                <p>In the JavaScript files of the Oracle JET modules where you
                    want to use it, include <tt>'knockout-postbox'</tt> in
                    the <tt>define</tt> block. Or maybe consider whether
                    it should be loaded in the <tt>require</tt> block in
                    the <tt>main.js</tt> file.</p>
            </li>
            
            <li>Now you can use <tt>knockout-postbox</tt>, as described on
                its home page: <a href="https://github.com/rniemeyer/knockout-postbox">https://github.com/rniemeyer/knockout-postbox</a>. For
                example:
                <ul>
                    <li><b>Publish.</b> In one of your Oracle JET modules, publish like this, in the
                         <tt>handleDetached</tt> lifecycle method:
<pre>self.name = ko.observable("John");

self.handleDetached = function(info) {
    ko.postbox.publish("currentUser", 
    {   
        'name': self.name()
    });
};</pre> 
                         <p>You could have an Oracle JET component, such as the
                         following, for changing the value in the module:</p>
<pre>Name: &lt;input id="text-input" 
             type="text"
             data-bind="ojComponent: {component: 'ojInputText', value: name}"/&gt;</pre>
                    </li>
                    <li><b>Subscribe.</b> In one of your other Oracle JET modules, subscribe
                         to the "currentUser" message published above, as follows:
<pre>self.name = ko.observable();

ko.postbox.subscribe("currentUser", function (newValue) {
    self.name(newValue.name);
});</pre>                    
<p>Finally, render changes to the message as follows in the module where you subscription code is found:</p>
<pre>Name: &lt;span data-bind="text: name"&gt;&lt;/span&gt;</pre>
                    </li>
                </ul>
            </li>    
            
        </ol>
        
        <p>Congratulations! You have now learned different approaches
             for setting up communication between Oracle JET modules.</p>

        <div class="feedback-box">
            <a href="/about/contact_form.html?to=3&amp;subject=Feedback:%20Getting%20Started%20with%20Oracle%20JET%20Applications">Send Feedback on This Tutorial</a>
        </div>

        <br style="clear:both;">

        <br>

        <h2 id="seealso">See Also</h2>

        <p>For more information about support for Oracle JET and a variety of HTML5 applications in the IDE on
            <a href="https://netbeans.org/">netbeans.org</a>, see the following resources:</p>

        <ul>
            <li><a href="http://www.oracle.com/webfolder/technetwork/jet/globalExamples.html">"Learn" section
                    on the Oracle JET site</a>. A set of official Oracle JET learning resources.</li>
            <li><a href="html5-editing-css.html">Working with CSS Style Sheets in HTML5 Applications</a>.
                A document that continues with the application that you created in this tutorial that demonstrates
                how to use some of the CSS wizards and windows in the IDE and how to use the Inspect mode in the
                Chrome browser to visually locate elements in your project sources.</li>
            <li><a href="html5-js-support.html">Debugging and Testing JavaScript in HTML5 Applications</a>.
                A document that demonstrates how the IDE provides tools that can help you debug and test
                JavaScript files in the IDE.</li>
        </ul>

    </body>
</html>